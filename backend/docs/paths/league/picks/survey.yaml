paths:
  survey:
    get:
      summary: Get survey(s) for provided episodeId and profileId
      description:
        Retrieves the survey for the specified profileId's in leagueId for
        episodeId's
      operationId: getSurveyForEpisodeForLeagueMember
      tags:
        - SurveyService
      parameters:
        - in: path
          name: leagueId
          required: true
          schema:
            type: string
            format: uuid
            description: The ID of the league.
            example: '1'
        - in: path
          name: profileId
          required: true
          schema:
            type: string
            format: uuid
            description: The ID of the profile.
            example: '1'
        - in: path
          name: episodeId
          required: true
          schema:
            type: string
            format: uuid
            description: The ID of the episode.
            example: '1'
      responses:
        '200':
          description:
            Retrieves a survey for the specified profileId in leagueId for
            episodeId
          content:
            application/json:
              schema:
                $ref: '#/components/responses/GetLeagueSurveyResponse'

  submitSurvey:
    post:
      summary: Submit survey for provided episodeId and profileId
      description:
        Submits the survey for the specified profileId's in leagueId for
        episodeId's
      operationId: submitSurveyWithPickChoices
      tags:
        - SurveyService
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/requestBodies/SubmitSurveyRequestBody'
      responses:
        '200':
          description:
            Submitted the survey for the specified profileId in leagueId for
            episodeId
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Survey submitted successfully'

components:
  requestBodies:
    GetSurveyRequestBody:
      type: object
      required:
        - episodeId
        - profileId
        - leagueId
      properties:
        episodeId:
          type: string
          format: uuid
          description: The ID of the episode.
          example: 1
        profileId:
          type: string
          format: uuid
          description: The ID of the profile.
          example: 1
        leagueId:
          type: string
          format: uuid
          description: The ID of the league.
          example: 1

    SubmitSurveyRequestBody:
      type: object
      required:
        - episodeId
        - leagueSurveyId
        - surveyId
        - leagueId
        - profileId
        - pickChoices
      properties:
        episodeId:
          type: string
          format: uuid
          description: The ID of the episode.
          example: 1
        leagueSurveyId:
          type: string
          format: uuid
          description: The ID of the league survey.
          example: 1
        surveyId:
          type: string
          format: uuid
          description: The ID of the survey.
          example: 1
        leagueId:
          type: string
          format: uuid
          description: The ID of the league.
          example: 1
        profileId:
          type: string
          format: uuid
          description: The ID of the profile.
          example: 1
        pickChoices:
          type: array
          items:
            $ref: '../../../components/survey/pick.yaml#/components/schemas/PickSelection'

  responses:
    GetLeagueSurveyResponse:
      type: object
      allOf:
        - $ref: '../../../components/common.yaml#/components/schemas/ApiResponse'
        - type: object
          required:
            - responseData
          properties:
            responseData:
              $ref: '#/components/schemas/GetLeagueSurveyResponseData'
  schemas:
    GetLeagueSurveyResponseData:
      type: object
      required:
        - leagueSurvey
        - isCompleted
      properties:
        leagueSurvey:
          oneOf:
            - $ref: '../../../components/survey/survey.yaml#/components/schemas/LeagueSurvey'
            - $ref: '../../../components/survey/survey.yaml#/components/schemas/CompletedLeagueSurvey'
        isCompleted:
          type: boolean
          description:
            Indicates if the survey is completed. If true, then leagueSurvey
            should be CompletedLeagueSurvey and if not then LeagueSurvey
          example: true
